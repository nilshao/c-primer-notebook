## 第三章 数据链路层

### abstract 

+ 链路层功能

+ 链路层的两种信道

+ 局域网，广域网

+ 链路层设备

### 数据链路层功能概述

数据链路层的研究思想：加头加尾 给物理层

### 基本概念

结点： 主机、路由器

*链路*：网络中两个结点之间的物理通道，

数据链路：网络中两个结点之间的逻辑通道，把实现控制数据传输协议的硬件和软件加到链路上就构成数据链路。

帧：链路层的协议数据单元，封装网络层数据报。

数据链路层负责通过一条链路从一个结点向另一个物理链路直接相连的相邻结点传送数据报。

### 功能概述

数据链路层在物理层提供服务的基础上向网络层提供服务，其最基本的服务是将源自网络层来的数据可靠地传输到相邻结点的目标机网络层。
其主要作用是加强物理层传输原始比特流的功能，将物理层提供的可能出错的物理连接改造成为逻辑上无差错的数据链路，使之对网络层表现为一条无差错的链路。

+ 功能一：为网络层提供服务，无确认无连接服务，有确认无连接服务，有确认面向连接服务。

+ 功能二：链路管理，即连接的建立、维持、释放（用于面向的服务）。

+ 功能三：组帧。

+ 功能四：流量控制：限制发送方。

+ 功能五：差错控制（帧错/位错）

### 封装成帧

封装成帧就是在一段数据的前后部分添加首部和尾部，这样就构成了一个帧。接收端在收到物理层上交的比特流后，就能根据首部和尾部的标记，从收到的比特流中识别帧的开始和结束。

首部和尾部包含许多的控制信息，他们的一个重要作用：帧定界（确定帧的界限）

+ 帧同步：接收方应该能从接收到的二进制比特流中区分出帧的起始和终止

+ 四种方法：字符计数法，字符（字节）填充法，零比特填充法，违规编码法

（图片）

#### 透明传输

透明传输是指不管所传数据是什么样的比特组合都应该能够在链路上传送。因此链路层就“看不见”有什么妨碍数据传输的东西。

当所传数据中比特组合恰好与某个控制信息完全一样时，就必须采取适当的措施，使得接收方不会将这样的数据误认为是某种控制信息，这样才能保证数据链路层的传输是透明的。

#### 字符计数法

帧首部用一个计数字段（第一个字节，八位）来标明帧内字符数。

#### 字符填充法

帧的三个部分：

（图片

+ SOH（start of header）00000001

+ 帧中的数据部分

+ EOT（end oftransmission）00000100

应用：传送文件是由文本文件组成时（文本文件字符都是从键盘上输入的，可用ascii码表达）。当传送的帧是由非ascii码的文本文件组成时（程序/图像等）就不行。可能在
信息中有和eot字段相同的组合，这时候就要采用字符填充的方法实现透明传输。

（图片

在与eot相同的字段前加转义字符esc作为字节填充，与转义字符esc相同的前面也要添加

#### 零比特填充法

操作：5-1-1-0 

+ 在发送端，扫描整个信息字段，只要连续5个1，就立即填入1个0

+ 在接收端收到一个帧时，先找到标志字段确定边界，再用硬件对 比特流 进行扫描。发现连续5个1时，就把后面的0删除。

保证了透明传输：在传送的比特流中可以传送任意比特组合，而不会引起对帧边界的判断错误。

#### 违规编码法  

如曼彻斯特编码中：前高后低是1，前低后高是0。所以可以用高-高，低-低来定界帧的起始和终止。

由于字节计数法中count字段的脆弱性，及字符填充实现上的复杂性和不兼容性，目前较普遍使用的帧同步法是比特填充和违规编码法。

### 差错控制

#### 差错从何而来

概括来说，传输中的差错都是由于噪声引起的。

全局性 

1. 由于线路本身电气特性所产生的随机噪声，是信道固有，随机存在的。

解决办法：提高信噪比来避免干扰

2. 外界特定的短暂原因所造成的冲击噪声，是产生差错的主要原因。解决办法：编码技术

差错：

+ 位错：比特位出错，1变0，0变1。

+ 帧错：丢失，重复，失序

#### 如何差错控制

比特错：

+ 检错编码：奇偶校验码，循环冗余编码CRC

+ 纠错编码：海明码

编码vs编码：

数据链路层编码和物理层数据编码与调制不同。物理层编码针对的是单个比特，解决传输过程中比特的同步等问题，如曼彻斯特编码。
而数据链路层的编码针对的是一组比特。他通过冗余码的技术实现一组二进制比特串在传输过程中是否出现了差错。

冗余编码：在数据发送之前，先按某种关系附加上一定的冗余位, 构成一个符合一定规则的码字再发送。
接收端根据收到码字是否仍符合原规则，来判断是否出错

#### 奇偶校验码

奇偶校验码：n-1位信息元，1位校验元。

+ 奇校验码：X..... n位：“1”的个数为奇数

+ 偶校验码反之

注意是加完校验码后，n长信息串中1的个数为奇数/偶数。and校验码在前面
